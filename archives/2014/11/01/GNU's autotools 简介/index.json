{"summary":"<p>我自己的放在Github上的bc命令行计算器工程在travis持续集成的编译中总是出现一些问题，经过分析这是由于不正确使用autotools导致的，这就促使我学习一下autotools工具包的原理及使用方式。</p>\n<a id=\"more\"></a>\n<p>一般我们在Linux下通过源码安装软件一般都是通过一下形式安装的</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure &amp;&amp; make &amp;&amp; make install</span><br></pre></td></tr></table></figure>\n<p>这就涉及到autotools(主要涉及三个命令autoconf、automake、libtool)</p>\n<p>可通过”sudo apt-get install automake”来安装autotools系列工具</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ aclocal</span><br><span class=\"line\">程序 'aclocal' 已包含在下列软件包中：</span><br><span class=\"line\"> * automake</span><br><span class=\"line\"> * automake1.10</span><br><span class=\"line\"> * automake1.11</span><br><span class=\"line\"> * automake1.4</span><br><span class=\"line\"> * automake1.9</span><br><span class=\"line\">请尝试：sudo apt-get install &lt;选定的软件包&gt;</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ sudo apt-get install automake</span><br><span class=\"line\">正在读取软件包列表... 完成</span><br><span class=\"line\">正在分析软件包的依赖关系树</span><br><span class=\"line\">正在读取状态信息... 完成</span><br><span class=\"line\">将会安装下列额外的软件包：</span><br><span class=\"line\">  autoconf autotools-dev</span><br><span class=\"line\">建议安装的软件包：</span><br><span class=\"line\">  autoconf2.13 autoconf-archive gnu-standards autoconf-doc libtool</span><br><span class=\"line\">下列【新】软件包将被安装：</span><br><span class=\"line\">  autoconf automake autotools-dev</span><br><span class=\"line\">......</span><br></pre></td></tr></table></figure>\n<p>以下是我<a href=\"http://inti.sourceforge.net/tutorial/libinti/autotoolsproject.html\" target=\"_blank\" rel=\"noopener\">Building a GNU Autotools Project</a>这篇文章的使用autotools实践的一个简单的例子<br>用到的文件如下</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ cat configure.ac</span><br><span class=\"line\">AC_INIT(src/main.cc)</span><br><span class=\"line\"></span><br><span class=\"line\">PACKAGE=helloworld</span><br><span class=\"line\">VERSION=0.1.0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">AM_INIT_AUTOMAKE($</span><span class=\"bash\">PACKAGE, <span class=\"variable\">$VERSION</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\">INTI_REQUIRED_VERSION=1.0.7</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">PKG_CHECK_MODULES(INTI, inti-1.0 &gt;= <span class=\"variable\">$INTI_REQUIRED_VERSION</span>)</span></span><br><span class=\"line\">AC_SUBST(INTI_CFLAGS)</span><br><span class=\"line\">AC_SUBST(INTI_LIBS)</span><br><span class=\"line\"></span><br><span class=\"line\">AC_PROG_CXX</span><br><span class=\"line\"></span><br><span class=\"line\">AC_OUTPUT(Makefile src/Makefile)</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ cat Makefile.am</span><br><span class=\"line\">AUTOMAKE_OPTIONS = foreign</span><br><span class=\"line\">SUBDIRS = src</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ cat src/Makefile.am</span><br><span class=\"line\">bin_PROGRAMS = helloworld</span><br><span class=\"line\"></span><br><span class=\"line\">AM_CXXFLAGS = $(INTI_CFLAGS)</span><br><span class=\"line\"></span><br><span class=\"line\">helloworld_SOURCES = main.cc helloworld.cc helloworld.h</span><br><span class=\"line\">helloworld_LDADD = $(INTI_LIBS)</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ cat src/helloworld.h</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">ifndef _HELLOWORLD_H</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">define _HELLOWORLD_H</span></span><br><span class=\"line\"></span><br><span class=\"line\">int max(int a, int b);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">endif</span></span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ cat src/helloworld.cc</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">include <span class=\"string\">\"helloworld.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">int max(int a, int b)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    return a &gt; b ? a : b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ cat src/main.cc</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">include &lt;iostream&gt;</span></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">include <span class=\"string\">\"helloworld.h\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">using namespace std;</span><br><span class=\"line\"></span><br><span class=\"line\">int main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    int a = 10;</span><br><span class=\"line\">    int b = 5;</span><br><span class=\"line\">    int c = max(a,b);</span><br><span class=\"line\">    cout &lt;&lt; \"max(a,b):\" &lt;&lt; c &lt;&lt; endl;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br></pre></td></tr></table></figure>\n<p>高亮部分为每个阶段生产的新文件，详情注释部分</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ # 初始的必须文件(configure.ac、Makefile.am，configure.ac可通过autoscan生成configure.scan修改而来)</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ # configure.in已过时，使用configure.ac代替</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ tree</span><br><span class=\"line\">.</span><br><span class=\"line\">├── configure.in</span><br><span class=\"line\">├── Makefile.am</span><br><span class=\"line\">└── src</span><br><span class=\"line\">    ├── helloworld.cc</span><br><span class=\"line\">    ├── helloworld.h</span><br><span class=\"line\">    ├── main.cc</span><br><span class=\"line\">    └── Makefile.am</span><br><span class=\"line\"></span><br><span class=\"line\">1 directory, 6 files</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ # 通过执行aclocal生成aclocal.m4（包含configure.ac中用到的宏，如AM_INIT_AUTOMAKE），以及autom4te.cache（用于加速autotools运行的缓存）</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ aclocal</span><br><span class=\"line\">aclocal: warning: autoconf input should be named 'configure.ac', not 'configure.in'</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ mv configure.in configure.ac</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ aclocal</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ tree</span><br><span class=\"line\">.</span><br><span class=\"line\">├── aclocal.m4</span><br><span class=\"line\">├── autom4te.cache</span><br><span class=\"line\">│   ├── output.0</span><br><span class=\"line\">│   ├── output.1</span><br><span class=\"line\">│   ├── requests</span><br><span class=\"line\">│   ├── traces.0</span><br><span class=\"line\">│   └── traces.1</span><br><span class=\"line\">├── configure.ac</span><br><span class=\"line\">├── Makefile.am</span><br><span class=\"line\">└── src</span><br><span class=\"line\">    ├── helloworld.cc</span><br><span class=\"line\">    ├── helloworld.h</span><br><span class=\"line\">    ├── main.cc</span><br><span class=\"line\">    └── Makefile.am</span><br><span class=\"line\"></span><br><span class=\"line\">2 directories, 12 files</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll | wc -l</span><br><span class=\"line\">8</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll</span><br><span class=\"line\">总用量 64</span><br><span class=\"line\">drwxrwxr-x 4 liudonghua liudonghua  4096 11月  1 15:33 ./</span><br><span class=\"line\">drwxrwxr-x 5 liudonghua liudonghua  4096 11月  1 15:32 ../</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua 39670 11月  1 15:33 aclocal.m4</span><br><span class=\"line\">drwxr-xr-x 2 liudonghua liudonghua  4096 11月  1 15:33 autom4te.cache/</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua   272 11月  1 13:28 configure.ac</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua    41 11月  1 14:31 Makefile.am</span><br><span class=\"line\">drwxrwxr-x 2 liudonghua liudonghua  4096 11月  1 15:30 src/</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ # automake --add-missing（简写成automake -a）用于生成一些autotools运行必要的脚本（其实是链接到automake安装目录下），如depcomp、install-sh、missing、Makefile.in（需要Makefile.am）</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ automake --add-missing</span><br><span class=\"line\">configure.ac:6: warning: AM_INIT_AUTOMAKE: two- and three-arguments forms are deprecated.  For more info, see:</span><br><span class=\"line\">configure.ac:6: http://www.gnu.org/software/automake/manual/automake.html#Modernize-AM_005fINIT_005fAUTOMAKE-invocation</span><br><span class=\"line\">configure.ac:6: installing './install-sh'</span><br><span class=\"line\">configure.ac:6: installing './missing'</span><br><span class=\"line\">src/Makefile.am: installing './depcomp'</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll | wc -l</span><br><span class=\"line\">12</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll</span><br><span class=\"line\">总用量 88</span><br><span class=\"line\">drwxrwxr-x 4 liudonghua liudonghua  4096 11月  1 15:35 ./</span><br><span class=\"line\">drwxrwxr-x 5 liudonghua liudonghua  4096 11月  1 15:32 ../</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua 39670 11月  1 15:33 aclocal.m4</span><br><span class=\"line\">drwxr-xr-x 2 liudonghua liudonghua  4096 11月  1 15:35 autom4te.cache/</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua   272 11月  1 13:28 configure.ac</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua    32 11月  1 15:35 depcomp -&gt; /usr/share/automake-1.14/depcomp*</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua    35 11月  1 15:35 install-sh -&gt; /usr/share/automake-1.14/install-sh*</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua    41 11月  1 14:31 Makefile.am</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua 23457 11月  1 15:35 Makefile.in</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua    32 11月  1 15:35 missing -&gt; /usr/share/automake-1.14/missing*</span><br><span class=\"line\">drwxrwxr-x 2 liudonghua liudonghua  4096 11月  1 15:35 src/</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ # autoconf生成最终的configure脚本</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ autoconf</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll | wc -l</span><br><span class=\"line\">13</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll</span><br><span class=\"line\">总用量 88</span><br><span class=\"line\">drwxrwxr-x 4 liudonghua liudonghua  4096 11月  1 15:35 ./</span><br><span class=\"line\">drwxrwxr-x 5 liudonghua liudonghua  4096 11月  1 15:32 ../</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua 39670 11月  1 15:33 aclocal.m4</span><br><span class=\"line\">drwxr-xr-x 2 liudonghua liudonghua  4096 11月  1 15:35 autom4te.cache/</span><br><span class=\"line\">-rwxrwxr-x 1 liudonghua liudonghua 131248 11月  1 15:36 configure*</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua   272 11月  1 13:28 configure.ac</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua    32 11月  1 15:35 depcomp -&gt; /usr/share/automake-1.14/depcomp*</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua    35 11月  1 15:35 install-sh -&gt; /usr/share/automake-1.14/install-sh*</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua    41 11月  1 14:31 Makefile.am</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua 23457 11月  1 15:35 Makefile.in</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua    32 11月  1 15:35 missing -&gt; /usr/share/automake-1.14/missing*</span><br><span class=\"line\">drwxrwxr-x 2 liudonghua liudonghua  4096 11月  1 15:35 src/</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ # 生成最终的Makefile以及一些日志文件config.log、config.status</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ./configure</span><br><span class=\"line\">checking for a BSD-compatible install... /usr/bin/install -c</span><br><span class=\"line\">checking whether build environment is sane... yes</span><br><span class=\"line\">checking for a thread-safe mkdir -p... /bin/mkdir -p</span><br><span class=\"line\">checking for gawk... no</span><br><span class=\"line\">checking for mawk... mawk</span><br><span class=\"line\">checking whether make sets $(MAKE)... yes</span><br><span class=\"line\">checking whether make supports nested variables... yes</span><br><span class=\"line\">......</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll | wc -l</span><br><span class=\"line\">16</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$ ll</span><br><span class=\"line\">总用量 288</span><br><span class=\"line\">drwxrwxr-x 4 liudonghua liudonghua   4096 11月  1 15:37 ./</span><br><span class=\"line\">drwxrwxr-x 5 liudonghua liudonghua   4096 11月  1 15:32 ../</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua  39670 11月  1 15:33 aclocal.m4</span><br><span class=\"line\">drwxr-xr-x 2 liudonghua liudonghua   4096 11月  1 15:35 autom4te.cache/</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua   9035 11月  1 15:37 config.log</span><br><span class=\"line\">-rwxrwxr-x 1 liudonghua liudonghua  28973 11月  1 15:37 config.status*</span><br><span class=\"line\">-rwxrwxr-x 1 liudonghua liudonghua 131248 11月  1 15:36 configure*</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua    272 11月  1 13:28 configure.ac</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua     32 11月  1 15:35 depcomp -&gt; /usr/share/automake-1.14/depcomp*</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua     35 11月  1 15:35 install-sh -&gt; /usr/share/automake-1.14/install-sh*</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua  23727 11月  1 15:37 Makefile</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua     41 11月  1 14:31 Makefile.am</span><br><span class=\"line\">-rw-rw-r-- 1 liudonghua liudonghua  23457 11月  1 15:35 Makefile.in</span><br><span class=\"line\">lrwxrwxrwx 1 liudonghua liudonghua     32 11月  1 15:35 missing -&gt; /usr/share/automake-1.14/missing*</span><br><span class=\"line\">drwxrwxr-x 3 liudonghua liudonghua   4096 11月  1 15:38 src/</span><br><span class=\"line\">liudonghua@liudonghua-Ubuntu:~/tests/helloworld$</span><br></pre></td></tr></table></figure>\n<p>总结</p>\n<ol>\n<li>使用autotools封装自己的C\\C++程序，这样相比直接使用make可以更好的编译检测及屏蔽不同平台的一些环境差异，而且还支持打包、安装、卸载等功能</li>\n<li>使用autotools关键在于写configure.ac（一个）和Makefile.am（可能有多个）</li>\n<li>autoconf与automake没有执行先后顺序。autoconf需要输入configure.ac，输出configure；automake需要输入configure.ac和Makefile.am，输出Makfile.in</li>\n</ol>\n<p>configure.ac、Makefile.am规则可参考<br><a href=\"http://amjith.blogspot.com/2009/04/autoconf-and-automake-tutorial.html\" target=\"_blank\" rel=\"noopener\">Autoconf and Automake Tutorial</a><br><a href=\"http://mij.oltrelinux.com/devel/autoconf-automake/\" target=\"_blank\" rel=\"noopener\">A tutorial for porting to autoconf &amp; automake</a><br><a href=\"http://inti.sourceforge.net/tutorial/libinti/autotoolsproject.html\" target=\"_blank\" rel=\"noopener\">Building a GNU Autotools Project</a></p>\n<p>注：<br>“A tutorial for porting to autoconf &amp; automake”中的例子必须把src/Makefile.am中的-std=c99去掉或改成-<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Standards.html\" target=\"_blank\" rel=\"noopener\">std=gnu11</a><br>“Building a GNU Autotools Project”的configure.am中的”PKG_CHECK_MODULES(INTI, inti-1.0 &gt;= $INTI_REQUIRED_VERSION)”在一些环境下不可用</p>\n"}