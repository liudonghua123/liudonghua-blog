{"summary":"<p>或许大家都有感觉，国内因为google被屏蔽的原因，下载Android源码是一件非常痛苦的事情，不仅速度慢而且下载过程中有时候会网络中断，要想一次性完整下载几乎很难，最近看到一片文章提到可以免费使用一年Amazon的EC2云服务器，今年尝试了一下，还是非常不错，相比阿里云的ECS感觉一个明显的优点是官方或社区提供了非常多的AMI（有些类似于安装有特定软件的系统镜像），如想搭建一个wordpress可以很快找到一个配置好的服务器环境，然后就可以直接使用了。</p>\n<a id=\"more\"></a>\n<p>今天测试了一下，下载Android master分支源码，下载完成后总共28G（其实就下载了13G，即.repo目录的大小），总共用了1931s，大概就半小时。</p>\n<p>其中用到的一些命令如下</p>\n<p>使用screen保持远程连接会话，防止终端连接中断后下载进程也停止</p>\n<h1 id=\"创建一个名称为android的会话\"><a href=\"#创建一个名称为android的会话\" class=\"headerlink\" title=\"创建一个名称为android的会话\"></a>创建一个名称为android的会话</h1><p>screen -S android</p>\n<h1 id=\"查看目前已有的会话\"><a href=\"#查看目前已有的会话\" class=\"headerlink\" title=\"查看目前已有的会话\"></a>查看目前已有的会话</h1><p>screen -ls</p>\n<h1 id=\"恢复名称为android的会话连接（终端连接中断中使用）\"><a href=\"#恢复名称为android的会话连接（终端连接中断中使用）\" class=\"headerlink\" title=\"恢复名称为android的会话连接（终端连接中断中使用）\"></a>恢复名称为android的会话连接（终端连接中断中使用）</h1><p>screen -x android</p>\n<h1 id=\"安装Oracle的JDK\"><a href=\"#安装Oracle的JDK\" class=\"headerlink\" title=\"安装Oracle的JDK\"></a>安装Oracle的JDK</h1><p>sudo add-apt-repository ppa:webupd8team/java<br>sudo apt-get update<br>sudo apt-get install oracle-java6-installer<br>（如果要安装JDK7、8可以把oracle-java6-installer替换为oracle-java7-installer、oracle-java8-installer）</p>\n<h1 id=\"安装一些依赖库，适合ubuntu-14-04\"><a href=\"#安装一些依赖库，适合ubuntu-14-04\" class=\"headerlink\" title=\"安装一些依赖库，适合ubuntu 14.04\"></a>安装一些依赖库，适合ubuntu 14.04</h1><p>sudo apt-get install git gnupg flex bison gperf build-essential \\<br>zip curl libc6-dev libncurses5-dev x11proto-core-dev \\<br>libx11-dev libreadline6-dev libgl1-mesa-glx \\<br>libgl1-mesa-dev g++-multilib mingw32 tofrodos \\<br>python-markdown libxml2-utils xsltproc zlib1g-dev</p>\n<p>mkdir ~/bin<br>PATH=~/bin:$PATH</p>\n<p>curl <a href=\"https://storage.googleapis.com/git-repo-downloads/repo\" target=\"_blank\" rel=\"noopener\">https://storage.googleapis.com/git-repo-downloads/repo</a> &gt; ~/bin/repo<br>chmod a+x ~/bin/repo</p>\n<p>mkdir android<br>cd android</p>\n<h1 id=\"使用文本浏览器获取-netrc内容\"><a href=\"#使用文本浏览器获取-netrc内容\" class=\"headerlink\" title=\"使用文本浏览器获取.netrc内容\"></a>使用文本浏览器获取.netrc内容</h1><p>w3m <a href=\"https://android.googlesource.com/new-password\" target=\"_blank\" rel=\"noopener\">https://android.googlesource.com/new-password</a></p>\n<p>repo init -u <a href=\"https://android.googlesource.com/a/platform/manifest\" target=\"_blank\" rel=\"noopener\">https://android.googlesource.com/a/platform/manifest</a></p>\n<h1 id=\"记录下载Android源码日志（通过tee同时写到标准输出和文件）\"><a href=\"#记录下载Android源码日志（通过tee同时写到标准输出和文件）\" class=\"headerlink\" title=\"记录下载Android源码日志（通过tee同时写到标准输出和文件）\"></a>记录下载Android源码日志（通过tee同时写到标准输出和文件）</h1><p>repo sync -j2 2&gt;&amp;1 | tee ~/android_source_sync.log</p>\n<p>以下命令计算上一条命令的运行时间<br>start_time=<code>date +%s</code> \\<br>&amp;&amp; repo sync -j2 2&gt;&amp;1 | tee ~/android_source_sync.log \\<br>&amp;&amp; end_time=<code>date +%s</code> \\<br>&amp;&amp; echo execution time was <code>expr $end_time - $start_time</code> s.</p>\n"}