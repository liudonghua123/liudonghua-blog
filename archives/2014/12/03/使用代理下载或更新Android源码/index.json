{"summary":"<p>之前在AWS的EC2上下载Android源码，然后再下载到本地很麻烦，并且本地源码更新也经常会出现网络连接问题，后来突然想到不妨在AWS上设置代理，然后连接AWS上的代理更新本地代码。</p>\n<a id=\"more\"></a>\n<p>所以今天就尝试一下，由于我的AWS上EC2安装的是ubuntu系统，所以搜索了一下ubuntu下的代理服务器，一般都是用squid，那就这个吧。以下我以最少/最简配置说明，毕竟只是临时的。执行以下命令安装<br><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get update</span><br><span class=\"line\">sudo apt-get install squid3</span><br><span class=\"line\">sudo cp /etc/squid3/squid.conf /etc/squid3/squid.conf.original</span><br><span class=\"line\">sudo chmod a-w /etc/squid3/squid.conf.original</span><br></pre></td></tr></table></figure></p>\n<p>然后修改/etc/squid3/squid.conf配置文件<br>端口默认是http_port 3128<br>acl默认配置了一些允许或禁止访问规则（详见配置文件中的http_access allow xxx/http_access deny xxx），我为了简单，把http_access deny all注释掉，然后最后加上http_access allow all。然后重启squid服务器sudo service squid3 restart，这样远程代理服务器就配置好了。</p>\n<p>本地只要在执行repo init或repo sync之前设置两个环境变量即可<br>export http_proxy=<a href=\"http://your_aws_public_up:your_port\" target=\"_blank\" rel=\"noopener\">http://your_aws_public_up:your_port</a><br>export https_proxy=<a href=\"http://your_aws_public_up:your_port\" target=\"_blank\" rel=\"noopener\">http://your_aws_public_up:your_port</a><br>这样就可以无各种抓狂的网络问题的去下载/同步Android源码了，赶紧试一下去吧！</p>\n<p>其实squid功能很强大，acl设置可以限定ip/ip段/时间/…，还可以加上用户验证（用户名+密码）等。详见以下一些网址内容！</p>\n<p>参考资料</p>\n<ol>\n<li><a href=\"https://help.ubuntu.com/14.04/serverguide/squid.html\" target=\"_blank\" rel=\"noopener\">Squid - Proxy Server</a></li>\n<li><a href=\"https://www.linode.com/docs/networking/squid/squid-http-proxy-ubuntu-12-04\" target=\"_blank\" rel=\"noopener\">Creating an HTTP Proxy Using Squid on Ubuntu 12.04</a></li>\n<li><a href=\"http://wiki.ubuntu.com.cn/Squid\" target=\"_blank\" rel=\"noopener\">Squid</a></li>\n</ol>\n"}